<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="style.css">
    <title>Document</title>
</head>
<body>
<div class="main">
    <div class="innerbox">
        <div >
            <input id="get_location" type="text" placeholder="Input your location">
            <button type="button" class="btn btn-primary" onclick="getWeather()">Get weather</button>
            </div>
            <div id="weather">
                <h1>Weather for <span id='setLocation'></span></h1>
            <p>
                Location :  <span id = 'locationName'> currently unavailable</span> <br>
                Condition : <span id = 'condition'>currently unavailable </span> <br>
                Temperature : <span id = 'temp'> currently unavailable</span> <br>
                Feels Like : <span id = 'feelsLike'> currently unavailable</span> <br>
                Wind speed : <span id = 'windSpeed'>currently unavailable </span>
            </p>
        
        </div>
        <div id="error">
            <h3>Location not found , please search again</h3>
        
        </div>
    </div>
</div>

    <script>
        function hideElem() {
        document.getElementById("weather").style.visibility = "hidden";
        console.log('hidden called');
        }
        function hideError() {
        document.getElementById("error").style.visibility = "hidden";
        console.log('hidden called');
        }

        function showElem() {
        document.getElementById("weather").style.visibility = "visible";
        console.log('error show called');
}
        function showError() {
                document.getElementById("error").style.visibility = "visible";
                console.log('error show called');
                }

        async function getISS(){
            const issApi_url = 'https://api.wheretheiss.at/v1/satellites/25544'
            const response =await fetch (issApi_url);
            const data = await response.json();
            document.getElementById('lat').textContent=data.latitude;
            document.getElementById('lng').textContent=data.longitude;
            // alert(data.id);
        }
        async function getWeather(){
            hideError();
            let location = document.getElementById("get_location").value;
            const weatherApi_url = `https://api.openweathermap.org/data/2.5/weather?q=${location}&units=metric&appid=398e310b24f291b753fabdb60b31cc14`
            const response = await fetch (weatherApi_url);
            const data = await response.json();
            try{
                if (!data.name){
                    throw new SyntaxError("no data");
                }
                
            }
            catch(err){
                console.log("json error " + err);
                showError()
            }
            document.getElementById('setLocation').textContent=location;
            document.getElementById('temp').textContent=data.main.temp+'Â°C';
            document.getElementById('feelsLike').textContent=data.main.feels_like;
            document.getElementById('locationName').textContent= data.name;
            document.getElementById('windSpeed').textContent= data.wind.speed;
            document.getElementById('condition').textContent= data.weather[0].main;
            changeBackgroundUsingApiData(data.weather[0].id);
            showElem(weather);
        }
        function changeBackgroundUsingApiData(weatherStatus){

            if (weatherStatus>=200 && weatherStatus<300){
                document.body.style.backgroundImage = "url('img/storm.jpg')";
                document.body.style.color = "white"
                }
            else if (weatherStatus>=300 && weatherStatus<400){
                document.body.style.backgroundImage = "url('img/drizzle.png')";
                document.body.style.color = "white"
                }
            // if (weatherStatus>=200 && weatherStatus<200){
            //     document.body.style.backgroundImage = "url('img/rain.jpg')";
            //     // document.body.style.backgroundColor = "#c37d3c"
            //     document.body.style.color = "white"
            //     }
            else if (weatherStatus>=400 && weatherStatus<500){
                document.body.style.backgroundImage = "url('img/rainy.jpg')";
                document.body.style.color = "white"
                }
            else if (weatherStatus>=500 && weatherStatus<600){
                document.body.style.backgroundImage = "url('img/snow.jpg')";
                document.body.style.color = "white"
                }
            else if (weatherStatus>=700 && weatherStatus<800){
                document.body.style.backgroundImage = "url('img/haze.jpg')";
                document.body.style.color = "white"
                }
            else if (weatherStatus==800){
                document.body.style.backgroundImage = "url('img/clear.jpg')";
                document.body.style.color = "white"
                }
            else if (weatherStatus>800 && weatherStatus<900){
                document.body.style.backgroundImage = "url('img/clouds.jpg')";
                document.body.style.color = "white"
                }
            else {
                document.body.style.backgroundImage = "url(img/Black.png)";
                document.body.style.color = "white"
            }

               
        }
        hideElem();
        hideError();
    </script>



</body>
</html>